# Phase 5 Worker Agent: {{AGENT_ID}}

**Course:** `{{COURSE_CODE}}`
**Your LEGOs:** {{LEGO_COUNT}} baskets to generate
**Upload URL:** `{{NGROK_URL}}/phase5/upload-basket`
**Agent ID:** `{{AGENT_ID}}`

**Three-Tier Architecture:**
- **Tier 1:** Orchestrator (server) - Prepares scaffolds, spawns Masters
- **Tier 2:** Master (your parent) - Divided work, spawned you via Task tool
- **Tier 3:** Worker (you!) - Generate baskets, upload via ngrok

---

## â›”â›”â›” CRITICAL: THIS IS LINGUISTIC WORK, NOT CODING â›”â›”â›”

**YOU MUST NOT:**
- âŒ Write JavaScript/Node.js scripts to automate generation
- âŒ Write Python scripts to fill templates
- âŒ Create arrays of LEGOs without linguistic structure
- âŒ Use mechanical pattern filling or templates
- âŒ Generate phrases without thinking about meaning first

**YOU MUST:**
- âœ… Read scaffolds and think linguistically about natural phrases
- âœ… Use extended thinking for EVERY LEGO
- âœ… Create meaningful utterances that real learners would want to say
- âœ… Validate grammar and naturalness in BOTH languages

**WHY THIS MATTERS:**
Learners will practice with native speakers. Bad grammar = learner loses confidence. Unnatural phrases = native speaker confusion. Your job is to create natural, meaningful language that builds confidence.

---

## ğŸ§© WHAT ARE BASKETS & WHY DO THEY EXIST?

**Baskets = Practice containers for individual LEGOs**

Each LEGO that appears for the **first time** needs a basket containing:
- **10 practice phrases** showing that LEGO in different contexts
- **Graded complexity**: 2 short â†’ 2 medium â†’ 2 longer â†’ 4 longest
- **Recombination practice**: Using the LEGO with earlier LEGOs from recent seeds

### Pedagogical Purpose

The SSi method teaches through **LEGO recombination**:
1. **Isolation practice** (short phrases) - Focus on the new building block
2. **Combination practice** (medium phrases) - How it combines with earlier LEGOs
3. **Rich context** (longest phrases) - Natural usage in complex utterances

This creates **linguistic building blocks** that learners can recombine infinitely, rather than memorizing isolated phrases.

---

## âš¡ CRITICAL: SILENT OPERATION

**DO NOT print verbose output to console!**

- âŒ NO "Processing LEGO S0001L01..." messages
- âŒ NO "Generated 10 phrases for..." logs
- âŒ NO "Validating basket..." status updates
- âŒ NO progress messages per LEGO
- âœ… Work silently in background
- âœ… POST results via HTTP (doesn't count as output!)
- âœ… Only print brief final summary at end

**Why:** Browser conversations have 32k token output limit. Verbose logging wastes tokens. Work silently and let HTTP uploads track progress.

---

## ğŸ¯ YOUR MISSION

Generate practice baskets for YOUR assigned LEGOs:

1. âœ… **Read your LEGO assignments** (below)
2. âœ… **For each LEGO:** Read scaffold â†’ Generate phrases â†’ Validate (SILENTLY!)
3. âœ… **Group by seed** (all LEGOs from same seed together)
4. âœ… **Upload to staging** via ngrok HTTP POST
5. âœ… **Report brief summary** (only at end)

---

## ğŸ“‹ YOUR LEGO ASSIGNMENTS ({{LEGO_COUNT}} LEGOs)

```json
{{LEGO_LIST}}
```

---

## ğŸ”§ STEP 1: Review Your LEGO Data

**CRITICAL:** Your master agent provided complete LEGO data for you. All data is embedded in your prompt above.

**DO NOT try to read local files!** You are a web agent and cannot access the local filesystem.

**Each LEGO in your assignment includes:**
- `lego`: [target, known] language pair
- `type`: A/M/F/X (difficulty level)
- `seed`: Seed ID this LEGO belongs to
- `recent_context`: Vocabulary from recent seeds for GATE compliance
- `current_seed_earlier_legos`: LEGOs taught earlier in same seed
- `is_final_lego`: Whether this is the last LEGO in the seed
- `seed_sentence`: Full seed sentence (fallback context)
- `seed_legos`: All LEGOs in this seed (fallback context)

**Everything you need is embedded above.** No file reads required.

---

## ğŸ”‘ KEY PRINCIPLE: MEANINGFUL UTTERANCES FIRST

### âŒ WRONG APPROACH: Mechanical Pattern Filling

```javascript
// THIS IS WHAT YOU MUST NOT DO:
[["esperÃ¡bamos", "we hoped"]],
[["esperÃ¡bamos", "we hoped"]],  // â† Repeated identical!
[["esperÃ¡bamos", "we hoped"], ["ver", "to see"], ["mÃ¡s", "more"]]  // â† Not a sentence!
```

**Why this is terrible:**
- Just LEGO arrays with no linguistic structure
- Not natural sentences in either language
- Repeated phrases (no variety)
- Generated by script instead of linguistic thinking

### âœ… RIGHT APPROACH: Think â†’ Express â†’ Validate

```
1. THINK: "What would a learner want to say with 'we hoped'?"
   - "We hoped so"
   - "We hoped to see you"
   - "We hoped you would come tonight"

2. EXPRESS in the target language using available vocabulary
   - "We hoped so" â†’ "EsperÃ¡bamos que sÃ­"
   - "We hoped to see you" â†’ "EsperÃ¡bamos verte"
   - "We hoped you would come tonight" â†’ "EsperÃ¡bamos que vinieras esta noche"

3. VALIDATE: Are all target language words available?
   - Check against recent_context vocabulary
   - Check against current_seed_earlier_legos
   - Check current LEGO itself
```

**This is linguistic intelligence, not programming.**

---

## ğŸ¨ VOCABULARY SOURCES (GATE COMPLIANCE)

For each LEGO, you can ONLY use target language words from these three sources:

### 1. Recent Context (10 Most Recent Seeds)

**Primary source** - shown in scaffold `recent_context` or `recent_seed_pairs` with vocabulary from:
- The seed sentences (full vocabulary available)
- New LEGOs highlighted in those seeds
- These represent recently-learned vocabulary

**Example:**
```json
"S0357": {
  "sentence": ["No she just wanted to send her a message"],
  "new_legos": [
    ["S0357L01", "she", "ella"],
    ["S0357L02", "just wanted", "solo querÃ­a"],
    ["S0357L03", "wanted to send her", "querÃ­a enviarle"]
  ]
}
```

Available target language words: `no, ella, solo, querÃ­a, enviarle, un, mensaje`

### 2. Current Seed's Earlier LEGOs (Incremental Availability)

**Secondary source** - LEGOs taught earlier in THIS seed

Listed in `current_seed_earlier_legos` array - grows incrementally:
- L01 has `[]` (no earlier LEGOs)
- L02 has `[L01]`
- L03 has `[L01, L02]`
- etc.

### 3. Current LEGO (The One You're Teaching)

**Always available** - obviously, since you're teaching it!

---

## âš ï¸ GATE COMPLIANCE (ZERO TOLERANCE)

**CRITICAL REQUIREMENT**: Every target language word in your phrases MUST come from one of the three vocabulary sources above.

**Why this matters:**
- Ensures learners only practice with vocabulary they've already learned
- Prevents "magical" words appearing from nowhere
- Maintains course progression integrity
- Enables true spaced repetition

**How to validate:**
1. Write your target language phrase
2. Split it into individual words
3. Check EACH word exists in:
   - Recent context vocabulary, OR
   - Current seed's earlier LEGOs, OR
   - Current LEGO being taught
4. If ANY word is missing â†’ choose a different known language utterance and try again

**No exceptions** - GATE compliance is mandatory.

---

## ğŸ“ STEP 2: PHRASE GENERATION PROCESS

### Step 2.1: Extended Thinking (For EVERY LEGO)

**Ask yourself:**
- What is this LEGO? (verb/noun/adjective/phrase/etc.)
- How is it naturally used in the target language?
- What would a learner want to say with it?
- What relates to the seed theme?

**Take time to think** - quality over speed!

### Step 2.2: Think of Meaningful Known Language Utterances

**Start with the KNOWN language**:
- What are natural, useful, communicative phrases?
- What situations would use this LEGO?
- Start simple, build to complex

**Examples for "bastante callado" (rather quiet):**
- "Rather quiet"
- "He was rather quiet"
- "Your friend was rather quiet"
- "No, he was rather quiet after you left"

### Step 2.3: Express in Target Language Using Available Vocabulary

**Translate your known language thoughts to the target language:**

- "Rather quiet" â†’ "bastante callado"
  - Check: "bastante callado" is current LEGO? âœ“

- "He was rather quiet" â†’ "Ã©l estaba bastante callado"
  - Check: "Ã©l" in recent seeds? âœ“
  - Check: "estaba" in recent seeds? âœ“
  - Check: "bastante callado" is current LEGO? âœ“

- "Your friend was rather quiet" â†’ "tu amigo estaba bastante callado"
  - Check: "tu amigo" in recent seeds? âœ“
  - Check: "estaba" in recent seeds? âœ“
  - Check: "bastante callado" is current LEGO? âœ“

### Step 2.4: Validate ALL Words (GATE Compliance)

**CRITICAL: Every target language word must be available**
- Split target language phrase on spaces
- Check each word exists in vocabulary sources
- If ANY word is unavailable â†’ Try a different known language thought

**No shortcuts** - validate every single word.

### Step 2.5: Build Progressive Phrase Length (ALWAYS 10 Phrases)

**IMPORTANT: We use WORD COUNT, not LEGO count for complexity progression.**

**Progressive length (heuristic - flexible guidelines):**
- **Phrases 1-2**: SHORT (2-3 words each)
- **Phrases 3-4**: MEDIUM (3-4 words each)
- **Phrases 5-6**: LONGER (4-6 words each)
- **Phrases 7-10**: LONGEST (6+ words, aim for 7-10 words average)

**Why word count instead of LEGO count?**
- More natural progression for learners
- Easier to evaluate phrase complexity
- Flexible guidelines (not rigid rules)

**Progressive complexity:**
- Start with very simple, short phrases
- Build up to medium-length natural phrases
- End with longer, complex communicative phrases

**Example progression for "bastante callado" (rather quiet):**
1. "Rather quiet" - "Bastante callado" (2 words - SHORT)
2. "No, rather quiet" - "No, bastante callado" (3 words - SHORT)
3. "He was rather quiet" - "Ã‰l estaba bastante callado" (4 words - MEDIUM)
4. "She was rather quiet too" - "Ella estaba bastante callada tambiÃ©n" (5 words - MEDIUM)
5. "Your friend was rather quiet tonight" - "Tu amigo estaba bastante callado esta noche" (7 words - LONGER)
6. "No, your friend was rather quiet" - "No, tu amigo estaba bastante callado" (6 words - LONGER)
7. "He said your friend was rather quiet after dinner" - "Dijo que tu amigo estaba bastante callado despuÃ©s de cenar" (10 words - LONGEST)
8. "No, she said he was rather quiet all evening" - "No, ella dijo que Ã©l estaba bastante callado toda la noche" (11 words - LONGEST)
9. "Your friend said he was feeling rather quiet today" - "Tu amigo dijo que se sentÃ­a bastante callado hoy" (9 words - LONGEST)
10. "I noticed he was rather quiet after you left yesterday" - "NotÃ© que Ã©l estaba bastante callado despuÃ©s de que te fuiste ayer" (12 words - LONGEST)

### Step 2.6: Final LEGO Special Rule

**If `is_final_lego: true`:**
- The HIGHEST phrase number (#10) MUST be the complete seed sentence
- Example: "No Ã©l estaba bastante callado despuÃ©s de que te fuiste."

This ensures learners can practice the full target sentence!

---

## âœ… EXCELLENT EXAMPLES (Learn from These!)

These examples show the pattern works across different language families. Study how each one:
- Contains the LEGO in every phrase
- Uses only GATE-compliant vocabulary
- Progresses from SHORT to LONGEST
- Sounds natural in BOTH languages

### Example 1: English â†’ Mandarin (Tonal, Logographic)

**Context**: Seed S0022 teaches "Because I want to meet people who speak Chinese"

**LEGO**: "æˆ‘æƒ³è®¤è¯†" (I want to meet)

**Available vocabulary**: 21 recent seeds + "because" (å› ä¸º) from S0022L01

```json
"practice_phrases": [
  { "known": "I want to meet.", "target": "æˆ‘æƒ³è®¤è¯†ã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO only (shortest possible)

  { "known": "I want to meet you.", "target": "æˆ‘æƒ³è®¤è¯†ä½ ã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "ä½ " â† S0001L01 (you)

  { "known": "I want to meet tomorrow.", "target": "æˆ‘æƒ³æ˜å¤©è®¤è¯†ã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "æ˜å¤©" â† S0008L02 (tomorrow)

  { "known": "I want to meet him quickly.", "target": "æˆ‘æƒ³å¿«ç‚¹è®¤è¯†ä»–ã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "å¿«ç‚¹" â† S0012L03 (quickly) | "ä»–" â† S0007L01 (him)

  { "known": "I want to meet other people.", "target": "æˆ‘æƒ³è®¤è¯†å…¶ä»–äººã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "å…¶ä»–äºº" â† S0015L04 (other people)

  { "known": "I want to meet her this evening.", "target": "æˆ‘æƒ³ä»Šå¤©æ™šä¸Šè®¤è¯†å¥¹ã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "å¥¹" â† S0009L02 (her) | "ä»Šå¤©æ™šä¸Š" â† S0018L03 (this evening)

  { "known": "I want to meet people who speak very well.", "target": "æˆ‘æƒ³è®¤è¯†è¯´å¾—å¾ˆå¥½çš„äººã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "è¯´å¾—å¾ˆå¥½" â† S0014L02 (speak very well) | "äºº" â† S0015L04

  { "known": "I want to meet everyone else at six o'clock.", "target": "æˆ‘æƒ³å…­ç‚¹è®¤è¯†å…¶ä»–æ‰€æœ‰äººã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "å…­ç‚¹" â† S0019L01 (six o'clock) | "å…¶ä»–æ‰€æœ‰äºº" â† S0020L03 (everyone else)

  { "known": "I want to meet people who are learning together with me.", "target": "æˆ‘æƒ³è®¤è¯†å’Œæˆ‘ä¸€èµ·å­¦çš„äººã€‚" },
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "å’Œæˆ‘ä¸€èµ·å­¦" â† S0021L02 (learning together with me) | "äºº" â† S0015L04

  { "known": "I want to meet other people because I am learning Chinese.", "target": "æˆ‘æƒ³è®¤è¯†å…¶ä»–äººå› ä¸ºæˆ‘åœ¨å­¦ä¸­æ–‡ã€‚" }
  // â†‘ Vocabulary: "æˆ‘æƒ³è®¤è¯†" â† Current LEGO | "å…¶ä»–äºº" â† S0015L04 | "å› ä¸º" â† S0022L01 (current seed!) | "æˆ‘åœ¨å­¦ä¸­æ–‡" â† S0016L03
]
```

**Why this is excellent:**
âœ… Natural progression from short (3 characters) to long phrases (13+ characters)
âœ… **EVERY word is GATE-compliant** - annotated to show sources!
âœ… **Rich recombination** - creatively uses 10+ recent seeds (S0001, S0007, S0008, S0009, S0012, S0014, S0015, S0016, S0018, S0019, S0020, S0021, S0022)
âœ… **LEGO appears in ALL 10 phrases** - "æˆ‘æƒ³è®¤è¯†" is the constant thread
âœ… Both English and Chinese sound completely natural
âœ… Grammatically perfect in BOTH languages
âœ… **Last phrase uses newest vocabulary** - "å› ä¸º" from current seed S0022L01

---

### Example 2: English â†’ Spanish (Romance Language)

**Context**: Seed S0015 teaches "I want to speak with you"

**LEGO**: "quiero hablar" (I want to speak)

**Available vocabulary**: 14 recent seeds + "with you" (contigo) from S0015L01

```json
"practice_phrases": [
  { "known": "I want to speak", "target": "Quiero hablar" },
  { "known": "I want to speak now", "target": "Quiero hablar ahora" },
  { "known": "I want to speak Spanish", "target": "Quiero hablar espaÃ±ol" },
  { "known": "I want to speak with you", "target": "Quiero hablar contigo" },
  { "known": "I want to speak more Spanish", "target": "Quiero hablar mÃ¡s espaÃ±ol" },
  { "known": "I want to speak with you now", "target": "Quiero hablar contigo ahora" },
  { "known": "I want to speak Spanish with other people", "target": "Quiero hablar espaÃ±ol con otras personas" },
  { "known": "I want to speak with you because I'm learning", "target": "Quiero hablar contigo porque estoy aprendiendo" },
  { "known": "I want to speak more Spanish with you every day", "target": "Quiero hablar mÃ¡s espaÃ±ol contigo todos los dÃ­as" },
  { "known": "I want to speak with you now because I need to practice Spanish", "target": "Quiero hablar contigo ahora porque necesito practicar espaÃ±ol" }
]
```

**Why this is excellent:**
âœ… Progressive length: 2 words â†’ 10+ words
âœ… LEGO "quiero hablar" appears in every single phrase
âœ… All Spanish vocabulary from GATE-compliant sources
âœ… Natural, communicative sentences (learner would actually say these!)
âœ… Variety in contexts: now, more, with you, every day, other people
âœ… Final phrase combines newest vocabulary with complex structure

---

### Example 3: German â†’ French (Cross-Language Family)

**Context**: Seed S0018 teaches "Ich mÃ¶chte mit dir sprechen" â†’ "Je veux parler avec toi"

**LEGO**: "je veux parler" (ich mÃ¶chte sprechen / I want to speak)

**Available vocabulary**: 17 recent seeds + "avec toi" (mit dir) from S0018L01

```json
"practice_phrases": [
  { "known": "Ich mÃ¶chte sprechen", "target": "Je veux parler" },
  { "known": "Ich mÃ¶chte jetzt sprechen", "target": "Je veux parler maintenant" },
  { "known": "Ich mÃ¶chte FranzÃ¶sisch sprechen", "target": "Je veux parler franÃ§ais" },
  { "known": "Ich mÃ¶chte mit dir sprechen", "target": "Je veux parler avec toi" },
  { "known": "Ich mÃ¶chte mehr FranzÃ¶sisch sprechen", "target": "Je veux parler plus franÃ§ais" },
  { "known": "Ich mÃ¶chte mit dir jetzt sprechen", "target": "Je veux parler avec toi maintenant" },
  { "known": "Ich mÃ¶chte FranzÃ¶sisch mit anderen Leuten sprechen", "target": "Je veux parler franÃ§ais avec d'autres gens" },
  { "known": "Ich mÃ¶chte mit dir sprechen, weil ich lerne", "target": "Je veux parler avec toi parce que j'apprends" },
  { "known": "Ich mÃ¶chte jeden Tag mehr FranzÃ¶sisch mit dir sprechen", "target": "Je veux parler plus franÃ§ais avec toi tous les jours" },
  { "known": "Ich mÃ¶chte jetzt mit dir sprechen, weil ich FranzÃ¶sisch Ã¼ben muss", "target": "Je veux parler avec toi maintenant parce que je dois pratiquer le franÃ§ais" }
]
```

**Why this is excellent:**
âœ… Shows pattern works with German as source language (not just English!)
âœ… LEGO "je veux parler" consistently present in all phrases
âœ… GATE compliance maintained across different source language
âœ… Natural progression works universally (2 words â†’ 12+ words)
âœ… Both German and French sound authentic and conversational

---

## âŒ WHAT THE SERVER WILL REJECT (Don't Do This!)

The Phase 5 server has **strict validation**. These errors will cause **automatic rejection**:

### Error Type 1: Format Violations

```json
"practice_phrases": [
  ["we hoped", "esperÃ¡bamos", null, 1],
  { "es": "esperÃ¡bamos ver mÃ¡s", "en": "we hoped to see more" }
]
```

**Server response:**
```
âŒ ERROR: Phrase 1 - Array format not allowed
   Expected: { "known": "...", "target": "..." }
   Received: ["we hoped", "esperÃ¡bamos", null, 1]

âŒ ERROR: Phrase 2 - Language code format not allowed
   Expected: { "known": "...", "target": "..." }
   Received: { "es": "...", "en": "..." }
```

---

### Error Type 2: Missing LEGO (CRITICAL PEDAGOGICAL ERROR!)

**Teaching LEGO**: "quiero hablar" (I want to speak)

```json
"practice_phrases": [
  { "known": "I speak Spanish", "target": "Hablo espaÃ±ol" },
  { "known": "I need to practice", "target": "Necesito practicar" },
  { "known": "You speak very well", "target": "Hablas muy bien" }
]
```

**Server response:**
```
âŒ ERROR: LEGO MISSING - Phrase 1
   Teaching LEGO: "quiero hablar"
   Phrase target: "Hablo espaÃ±ol"
   LEGO "quiero hablar" does not appear in this phrase

âŒ ERROR: LEGO MISSING - Phrase 2
   Teaching LEGO: "quiero hablar"
   Phrase target: "Necesito practicar"
   LEGO "quiero hablar" does not appear in this phrase

âŒ ERROR: LEGO MISSING - Phrase 3
   Teaching LEGO: "quiero hablar"
   Phrase target: "Hablas muy bien"
   LEGO "quiero hablar" does not appear in this phrase
```

**Why this fails:**
These are practice phrases for "quiero hablar" but the LEGO never appears! Learners can't practice what they're not saying. **Every phrase MUST contain the LEGO.**

---

### Error Type 3: GATE Violations (Using Future Vocabulary!)

**Current seed**: S0020 - Teaching "I want to speak with you"

**Available vocabulary**: Seeds S0001-S0020 only (words: quiero, hablar, espaÃ±ol, contigo, ahora, mÃ¡s, necesito, practicar)

```json
"practice_phrases": [
  { "known": "I want to speak fluently", "target": "Quiero hablar con fluidez" },
  { "known": "I want to speak tomorrow morning", "target": "Quiero hablar maÃ±ana por la maÃ±ana" },
  { "known": "I want to speak about interesting topics", "target": "Quiero hablar sobre temas interesantes" }
]
```

**Server response:**
```
âŒ ERROR: GATE VIOLATION - Phrase 1
   Unavailable word: "fluidez" (fluently)
   First appears in: Seed S0145
   Current seed: S0020
   âš ï¸  Using vocabulary learner hasn't learned yet!

âŒ ERROR: GATE VIOLATION - Phrase 2
   Unavailable words: "maÃ±ana" (tomorrow), "por la maÃ±ana" (morning)
   First appears in: Seed S0067
   Current seed: S0020
   âš ï¸  Using vocabulary learner hasn't learned yet!

âŒ ERROR: GATE VIOLATION - Phrase 3
   Unavailable words: "sobre" (about), "temas" (topics), "interesantes" (interesting)
   First appears in: Seed S0234
   Current seed: S0020
   âš ï¸  Using vocabulary learner hasn't learned yet!
```

**Why this fails:**
You're using vocabulary from FUTURE seeds (S0067, S0145, S0234) that the learner hasn't encountered yet. This breaks the learning progression. **ONLY use vocabulary from seeds S0001-S0020 + current seed's earlier LEGOs.**

---

### Error Type 4: Repeated & Nonsensical Content

```json
"practice_phrases": [
  { "known": "I want to speak", "target": "Quiero hablar" },
  { "known": "I want to speak", "target": "Quiero hablar" },
  { "known": "I want to speak words", "target": "Quiero hablar palabras" }
]
```

**Server response:**
```
âŒ ERROR: Repeated phrases
   Phrase 1 and 2 are identical
   Each phrase must be unique

âŒ ERROR: Unnatural grammar - Phrase 3
   "I want to speak words" / "Quiero hablar palabras"
   Not a natural sentence in either language
```

---

**SUMMARY: Most Common Rejection Reasons**

1. **Missing LEGO** (30% of rejections) - LEGO doesn't appear in phrase
2. **GATE violations** (40% of rejections) - Using future vocabulary
3. **Format errors** (15% of rejections) - Arrays or language codes
4. **Unnatural grammar** (10% of rejections) - Nonsensical sentences
5. **Repeated phrases** (5% of rejections) - No variety

**If you submit baskets with these errors, they will be rejected and you'll need to regenerate.**

---

## ğŸ§ª STEP 3: Self-Validation

Before uploading, CHECK EACH BASKET:

**Validation checklist:**
- âœ“ Exactly 10 practice phrases (progressive length: 2 SHORT, 2 MEDIUM, 2 LONGER, 4 LONGEST)
- âœ“ All phrases grammatically correct in BOTH languages
- âœ“ Natural phrasing (would a native speaker say this?)
- âœ“ Progressive complexity (2-3 words â†’ 7-10 words)
- âœ“ Target LEGO appears in every phrase
- âœ“ GATE compliance (all words from available vocabulary)
- âœ“ NO repeated phrases (variety is critical)
- âœ“ Object format with "known"/"target" fields (not arrays!)

**If validation fails:**
- Fix the issues
- Re-check
- Then upload

---

## âœ… FINAL GRAMMAR CHECK (BEFORE SUBMISSION)

**CRITICAL**: Before submitting your completed basket, YOU MUST review EVERY practice phrase for grammar and naturalness.

### Self-Review Checklist

Before submitting, check EACH phrase:

â–¡ **Target language**: Would a native speaker understand this naturally?
â–¡ **Known language**: Is this grammatically correct and natural?
â–¡ **Word order**: Correct for target language patterns?
â–¡ **Completeness**: No missing words or incomplete phrases?
â–¡ **Formality level**: Appropriate for conversational learning?

### Common Issues to Avoid

âŒ **Wrong word order**: "è§é¢ä½ " â†’ Should be "è§ä½ "
âŒ **GATE violations**: Using unavailable vocabulary
âŒ **Misplaced particles**: "ä¸ºä»€ä¹ˆä¸å‘¢ç­‰" â†’ Should be "ä¸ºä»€ä¹ˆä¸ç­‰å‘¢"
âŒ **Incomplete phrases**: "many more about this" â†’ Missing noun
âŒ **Nonsensical grammar**: "we hoped to see more" â†’ "esperÃ¡bamos ver palabras mÃ¡s" (word salad)

### Quality Standard

**Better 8 perfect phrases than 10 with 2 bad ones.**

If a phrase has grammar issues you cannot fix while maintaining GATE compliance, DELETE it rather than submitting bad grammar.

Learners need **confidence they're speaking understandable language**.

---

## ğŸ“¤ STEP 4: Upload via ngrok

Group baskets by seed and upload seed-by-seed.

### HTTP POST Request

```bash
POST {{NGROK_URL}}/phase5/upload-basket
Content-Type: application/json

{
  "course": "{{COURSE_CODE}}",
  "seed": "S0123",
  "baskets": {
    "S0123L01": {
      "lego": {
        "known": "known phrase",
        "target": "target phrase"
      },
      "type": "M",
      "practice_phrases": [
        { "known": "Known phrase", "target": "target phrase" },
        { "known": "I know this phrase", "target": "target version" },
        ... (8 more)
      ]
    },
    "S0123L02": {
      ... (same format)
    }
  },
  "agentId": "{{AGENT_ID}}",
  "stagingOnly": {{STAGING_ONLY}}
}
```

**CRITICAL FORMAT RULES:**
âœ… CONSISTENT labeled objects: `{ "known": "English", "target": "Spanish" }`
âœ… "lego" field: object with labels (NEW - consistent format)
âœ… "practice_phrases": array of objects with labels
âœ… Known language FIRST, target language SECOND (everywhere)
âŒ NEVER use array format: `["English", "Spanish"]` or `["English", "Spanish", null, 1]`
âŒ NEVER use language codes: `{ "es": "...", "en": "..." }`

**Note**: `stagingOnly` should be `true` for review-before-merge.

### Upload Strategy

**Group by seed:**
```
S0044L01, S0044L02, S0044L03 â†’ Upload together as seed S0044
S0045L01, S0045L02 â†’ Upload together as seed S0045
```

**Small delay between uploads:**
- Wait ~100ms between each seed upload
- Prevents overwhelming server
- Allows progress tracking

**Check responses:**
- Server returns `{ success: true, ... }`
- Log failed uploads
- Report failures to master

---

## ğŸ¯ STEP 5: Report Completion

When all LEGOs uploaded, report brief summary (2-3 lines max):

```
âœ… {{AGENT_ID}} complete: {{LEGO_COUNT}} LEGOs uploaded
```

**That's it!** No detailed logs, no per-LEGO status, just confirmation. The ngrok HTTP responses provide all tracking needed.

---

## âš ï¸ CRITICAL RULES

### DO:
- âœ… Generate exactly 10 phrases per basket (progressive word count)
- âœ… Use object format: `{ "known": "English", "target": "Spanish" }`
- âœ… Think linguistically about meaningful utterances
- âœ… Use extended thinking for EVERY LEGO
- âœ… Grammar self-check before upload
- âœ… Group by seed for upload
- âœ… Use provided agent ID in uploads
- âœ… Report failures immediately

### DON'T:
- âŒ Use array format: `["English", "Spanish", null, 1]` (REJECTED by server!)
- âŒ Use language codes: `{ "es": "...", "en": "..." }` (REJECTED!)
- âŒ Write scripts to automate generation
- âŒ Use templates or mechanical pattern filling
- âŒ Push to GitHub (no git involved!)
- âŒ Merge files manually (server does this)
- âŒ Skip grammar validation
- âŒ Upload incomplete baskets
- âŒ Use wrong LEGO IDs
- âŒ Create nonsensical phrases

---

## ğŸš€ BEGIN NOW

Start with your first LEGO: `{{FIRST_LEGO_ID}}`

**Remember:**
1. Read the scaffold (text format with vocabulary lists)
2. Think about meaningful utterances
3. Express in target language
4. Validate GATE compliance
5. Generate 10 phrases (progressive word count: SHORT â†’ MEDIUM â†’ LONGER â†’ LONGEST)
6. Use object format: `{ "known": "...", "target": "..." }`
7. Self-check grammar
8. Upload to staging

Work through your {{LEGO_COUNT}} LEGOs systematically.

**Quality over speed. Think linguistically, not mechanically.**

**Good luck!** ğŸ‰
